pico-8 cartridge // http://www.pico-8.com
version 41
__lua__

-- sokotiles
-- by schoblaska

function _init()
  board_buffer = 3
  sprites = {
    e = { 60, 12 },
    w = { 38, 12 },
    y = { 49, 12 },
    g = { 49, 1 },
    b = { 60, 1 },
    E = { 16, 12 },
    W = { 16, 1 },
    G = { 27, 1 },
    Y = { 27, 12 },
    B = { 38, 1 }
  }

  board = {
    "eeeeeeeee",
    "eeeeeeeee",
    "eeeeeeeee",
    "eeeeeeeee",
    "eeeeeeeee",
    "eeeeeeeee",
    "eeeeeeeee",
    "eeeeeewee",
    "eeeeeeeee"
  }

  pieces = {
    "..G......",
    "...EEE...",
    "......W..",
    "EEE...E..",
    ".E.....Y.",
    "..B....Y.",
    ".E.......",
    "...E.....",
    "........."
  }

  cls()
  rectfill(0, 0, 127, 127, 0)

  -- star field
  for i = 1, 300 do
    pset(rnd(128), rnd(128), rnd(16))
  end
end

function _update()
end

function _draw()
  draw_twinkles()
  draw_board()
end

function draw_twinkles()
  local is_black = rnd(20) < 19
  local color = is_black and 0 or rnd(15) + 1

  pset(rnd(128), rnd(128), color)
end

function draw_board()
  -- border
  rectfill(board_buffer + 8, board_buffer + 8, board_buffer + 112, board_buffer + 112, 5)

  for x = 1, 9 do
    for y = 1, 9 do
      local board_tile = board[y][x]
      local piece_tile = pieces[y][x]

      draw_square(sprites[board_tile], x, y)

      if piece_tile ~= "." then
        draw_square(sprites[piece_tile], x, y)
      end
    end
  end
end

function draw_square(sprite, x, y)
  sspr(sprite[1], sprite[2], 11, 11, x * 11 + board_buffer, y * 11 + board_buffer)
end

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d666666666dd666666666dd666666666d1111111111111111111111111111111110000000000000000000000000000000000000000000000
00000000000000006ddd777ddd56ddddbdddd56ddddddddd51111111111111111111111111111111110000000000000000000000000000000000000000000000
00000000000000006dddd7dddd56dddbbbddd56ddddddddd51111111111111111111111111111111110000000000000000000000000000000000000000000000
00000000000000006dddd7dddd56ddddbdddd56ddddddddd51111111111111111111111111111111110000000000000000000000000000000000000000000000
000000000000000067dd000dd756dbd000dbd56dcd000dcd51111bbb11111111ccc1111111111111110000000000000000000000000000000000000000000000
0000000000000000677700077756bbb000bbb56ccc000ccc51111bbb11111111ccc1111111111111110000000000000000000000000000000000000000000000
000000000000000067dd000dd756dbd000dbd56dcd000dcd51111bbb11111111ccc1111111111111110000000000000000000000000000000000000000000000
00000000000000006dddd7dddd56ddddbdddd56ddddddddd51111111111111111111111111111111110000000000000000000000000000000000000000000000
00000000000000006dddd7dddd56dddbbbddd56ddddddddd51111111111111111111111111111111110000000000000000000000000000000000000000000000
00000000000000006ddd777ddd56ddddbdddd56ddddddddd51111111111111111111111111111111110000000000000000000000000000000000000000000000
0000000000000000d5555555551d5555555551d55555555511111111111111111111111111111111110000000000000000000000000000000000000000000000
0000000000000000d666666666dd666666666d111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddddadddd5111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56dddaaaddd5111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddddadddd5111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddd000ddd5111177711111111aaa111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddd000ddd5111177711111111aaa111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddd000ddd5111177711111111aaa111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddddadddd5111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56dddaaaddd5111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
00000000000000006ddddddddd56ddddadddd5111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
0000000000000000d5555555551d5555555551111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
